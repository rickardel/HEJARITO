@model HEJARITO.Models.CourseEditor

@{
    ViewBag.Title = Model.Course.Name;
}

<div id="divCourseInfo" class="row">
    <div class="col-md-6" id="divCourseModuleListing">
        <h1>
            @Model.Course.Name
        </h1>
        <p>
            @Html.ActionLink("[Ändra]", "Edit", new { id = Model.Course.Id })

            @Html.DisplayNameFor(model => model.Course.StartDate):
            @Html.DisplayFor(model => model.Course.StartDate)
            @Html.DisplayNameFor(model => model.Course.EndDate):
            @Html.DisplayFor(model => model.Course.EndDate)

            @*@Html.ActionLink("[Ladda upp kursdokument]", "Create", "Documents", new { CourseId = Model.Course.Id }, "")*@
            @*@Ajax.ActionLink("[Ladda upp kursdokument]", "_Create", "Documents", new { CourseId = Model.Course.Id }, new AjaxOptions
                {
                    UpdateTargetId = "divFormContainer",
                    OnBegin = "onAjaxBegin",
                    OnComplete = "onAjaxComplete"

                })*@
            @*@Ajax.ActionLink("[Ladda upp kursdokument]", "Create", "Documents", new { CourseId = Model.Course.Id}, AjaxOptions{  })*@
            <a href="#" id="uploadCourseDocumentBtn" onclick="GetCourseDocumentForm()">[Ladda upp kursdokument]</a>
        </p>
        <span>
            @Html.DisplayFor(model => model.Course.Description)
        </span>
        <hr />
        @*<h2>Kursnnehåll</h2>
        <span id="divCourseModules">
            @{ Html.RenderPartial("_CourseModules", Model.Course.Modules.OrderBy(m => m.StartDate).ToList()); }
        </span>

        <h2>Registrerade Studenter</h2>
        <span id="divCourseStudents">
            @{ Html.RenderPartial("_CourseStudents", Model.Course.ApplicationUsers); }
        </span>*@
    </div>



</div>

<div id="divCourseModuleListing" class="row">

    <div class="col-lg-6">
        <div>
            <span id="divFormContainer"></span>
        </div>
        <h4>Kursnnehåll</h4>
        <span id="divCourseModules">
            @{ Html.RenderPartial("_CourseModules", Model.Course.Modules.OrderBy(m => m.StartDate).ToList()); }
        </span>
        <details>
            <summary>Lägg till modul</summary>
            <span id="divCreateCourseModule" class="col-lg-12">
                @{ Html.RenderPartial("_CreateCourseModule", Model); }
            </span>
        </details>
        <details>
            <summary>Lägg till Aktivitet</summary>
            <span id="divCreateModuleActivity" class="col-lg-12">
                @{ Html.RenderPartial("_CreateModuleActivity", Model.Activity); }
            </span>
        </details>
    </div>
        <div class="col-lg-6">
            <h4>Registrerade Studenter</h4>
            <span id="divCourseStudents">
                @{ Html.RenderPartial("_CourseStudents", Model.Course.ApplicationUsers); }
            </span>
            <details>
                <summary>Registrera elev</summary>
                <span id="divCreateCourseStudent">
                    @{ Html.RenderPartial("_CreateCourseStudent", Model); }
                </span>
            </details>
        </div>
    </div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>

        $(document).ready(function () {
            $("#btnCreateModule").on('click', function () {
                let q = $("#Module_Name").val();
                if (q.length > 1) {
                    $("#divCreateModuleActivity").load("/Activities/GetActivityForm", { Id: 2 });
                }

                //alert(createdModuleName);
            });
            var url = '@Url.Action("PartialCreate", "Documents")';
            $("uploadCourseDocumentBtn").click(function () {
                //$("divFormContainer").load(url, { CourseId = Module.Course.Id })
                //$("divFormContainer").load("www.google.com");
                alert("first one worked");
            })
        });
        function GetCourseDocumentForm() {
            //alert("should work");
            $("#divFormContainer").load('@Html.Raw(@Url.Action("PartialCreate", "Documents", new { @courseId = Model.Course.Id, @documentType = 0}))');
        }
        @*function GetModuleDocumentForm(modelId) {
            var M = modelId;
            $("#divFormContainer").load(
                '@Html.Raw(@Url.Action("PartialCreate", "Documents", new { @courseId = Model.Course.Id, @documentType = 0, @moduleId = M }))'
            );
        }*@

        function onAjaxBegin() {
            $("#divFormContainer").slideUp();
        }

        function onAjaxComplete() {
            $("#divFormContainer").slideDown();
        }
    </script>
}
